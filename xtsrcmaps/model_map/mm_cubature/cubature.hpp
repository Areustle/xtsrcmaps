#pragma once

#include "xtsrcmaps/model_map/mm_cubature/points_weights.hpp"

#include "xtsrcmaps/sky_geom/sky_geom.hxx"
#include "xtsrcmaps/tensor/tensor.hpp"



namespace Fermi {

auto cubature_convolve_map_psf(
    size_t const             Nh,
    size_t const             Nw,
    Tensor<double, 2> const& src_sphcrds,
    Tensor<double, 3> const& psf_lut, // psf lookup table [Source, Seps, Energy]
    SkyGeom<double> const&   skygeom) -> Tensor<double, 4>; //[SHWE]


constexpr size_t naive_4096_cardinality = 4096;
auto             naive_4096_ptswts(size_t const           Nh,
                                   size_t const           Nw,
                                   SkyGeom<double> const& skygeom) -> Tensor<double, 3>;


namespace CubatureSets {

/*********************************************************************************
 * Points and Weights for Symmetric Low Cardinality Square cubature models
 * Università degli Studi di Padova ~ Dipartimento di Matematica
 * Alvise Sommariva
 *
 * https://www.math.unipd.it/~alvise/POINTSETS/cub_square_lowcard.m
 *
 *******************************************************************************/
// function XYW=cub_square_lowcard(deg)
//
// %..........................................
// % RULES ON UNIT SQUARE [-1,1] x [-1,1]
// % THEY ARE OF THE LOWEST KNOWN CARDINALITY
// % FOR THOSE HAVING ALG. DEG. OF PRECISION
// % EQUAL TO deg.
// %..........................................
// % deg | card  | ptsout| neg w |  momerr   |
// %..........................................
// %   1 |     1 |     0 |     0 |  0.00e+00 |
// %   2 |     3 |     0 |     0 |  6.66e-16 |
// %   3 |     4 |     0 |     0 |  8.88e-16 |
// %   4 |     6 |     0 |     0 |  6.19e-15 |
// %   5 |     7 |     0 |     0 |  4.44e-16 |
// %   6 |    10 |     0 |     0 |  8.88e-16 |
// %   7 |    12 |     0 |     0 |  3.89e-16 |
// %   8 |    16 |     0 |     0 |  6.70e-15 |
// %   9 |    17 |     0 |     0 |  8.88e-16 |
// %  10 |    22 |     0 |     0 |  4.44e-16 |
// %  11 |    24 |     0 |     0 |  3.54e-16 |
// %  12 |    31 |     0 |     0 |  6.11e-16 |
// %  13 |    33 |     0 |     0 |  8.88e-16 |
// %  14 |    40 |     0 |     0 |  9.68e-16 |
// %  15 |    43 |     0 |     0 |  3.33e-16 |
// %..........................................
//
//
// switch deg
//
//
//     case  {0,1}
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :      1
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 0.000e+00
//
//         XYW=[
constexpr size_t N_SQUARE_Ddeg1                           = 1;
// clang-format off
constexpr std::array<double, 3 * N_SQUARE_Ddeg1> square_deg1 = {
 0.0000000000000000e+00,0.0000000000000000e+00,4.0000000000000000e+00
};
// clang-format on
//      	 	 ];
//
//
//     case  2
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :      3
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 6.661e-16
//
//         XYW=[
constexpr size_t                              N_SQUARE_D2 = 3;
constexpr std::array<double, 3 * N_SQUARE_D2> square_deg2 = {
    // clang-format off
6.5195423824820187e-01, 3.6234443150224283e-01, 1.4986810965113220e+00,
-8.0708768615832260e-01, 5.3223090388330219e-01, 1.0515300169687920e+00,
-8.8560869465524453e-02, -7.6059040841264647e-01, 1.4497888865198869e+00,
    // clang-format on
};
//      	 	 ];
//
//
//     case  3
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :      4
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 8.882e-16
//
//         XYW=[
constexpr size_t                              N_SQUARE_D3 = 4;
constexpr std::array<double, 3 * N_SQUARE_D3> square_deg3 = {
    // clang-format off
-5.7735026918962573e-01, -5.7735026918962573e-01, 1.0000000000000000e+00,
-5.7735026918962573e-01, 5.7735026918962573e-01, 1.0000000000000000e+00,
5.7735026918962573e-01, 5.7735026918962573e-01, 1.0000000000000000e+00,
5.7735026918962573e-01, -5.7735026918962573e-01, 1.0000000000000000e+00,
    // clang-format on
};
//      	 	 ];
//
//
//     case  4
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :      6
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 6.189e-15
//
//         XYW=[
constexpr size_t                              N_SQUARE_D4 = 6;
constexpr std::array<double, 3 * N_SQUARE_D4> square_deg4 = {
    // clang-format off
9.2986644738263968e-01, 6.3611974731085444e-02, 4.9792836608418672e-01,
-7.3290126188740268e-01, 5.9031452584256083e-01, 6.8830810694138667e-01,
3.8954464197192479e-01, 8.3253233270634852e-01, 6.3408498246426515e-01,
5.1692943621695087e-01, -8.8040023817214730e-01, 4.8568473223765679e-01,
-5.2231599755441137e-02, -1.5401678626059359e-01, 1.1806464051912580e+00,
-7.6935635990175555e-01, -6.9436877661343266e-01, 5.1334740708124749e-01,
    // clang-format on
};
//      	 	 ];
//
//
//     case  5
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :      7
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 4.441e-16
//
//         XYW=[
constexpr size_t                              N_SQUARE_D5 = 7;
constexpr std::array<double, 3 * N_SQUARE_D5> square_deg5 = {
    // clang-format off
-9.6609178307929600e-01, 0.0000000000000000e+00, 3.1746031746031750e-01,
-5.7735026918962584e-01, -7.7459666924148340e-01, 5.5555555555555558e-01,
-5.7735026918962584e-01, 7.7459666924148340e-01, 5.5555555555555558e-01,
0.0000000000000000e+00, 0.0000000000000000e+00, 1.1428571428571430e+00,
5.7735026918962584e-01, 7.7459666924148340e-01, 5.5555555555555558e-01,
5.7735026918962584e-01, -7.7459666924148340e-01, 5.5555555555555558e-01,
9.6609178307929600e-01, 0.0000000000000000e+00, 3.1746031746031750e-01,
    // clang-format on
};
//      	 	 ];
//
//
//     case  6
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     10
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 8.882e-16
//
//         XYW=[
constexpr size_t                              N_SQUARE_D6 = 10;
constexpr std::array<double, 3 * N_SQUARE_D6> square_deg6 = {
    // clang-format off
9.7851554768515625e-01, 2.0326637588453481e-01, 2.1151441014439010e-01,
8.0020711747967321e-01, -8.0682127897895684e-01, 2.6331285965627182e-01,
6.4784472711792929e-01, 8.1744371513452652e-01, 3.7653925842312708e-01,
4.5277404059185222e-01, -2.3171080882075001e-01, 7.1282611217343084e-01,
-4.7756687316929192e-01, 9.7665970771681543e-01, 1.9150808883269349e-01,
-7.5694201647991038e-02, 4.4090554015332512e-01, 7.6473989791974573e-01,
-1.2415632480353170e-01, -8.4092224990921993e-01, 4.4220792845026119e-01,
-9.0141589131564059e-01, 5.4831217200800897e-01, 2.8015103953997639e-01,
-6.5602776289784437e-01, -2.8664975296487949e-01, 6.5363086667165371e-01,
-9.5378715174532747e-01, -8.8615234300506329e-01, 1.0356953818844870e-01,
    // clang-format on
};
//      	 	 ];
//
//
//     case  7
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     12
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 3.886e-16
//
//         XYW=[
constexpr size_t                              N_SQUARE_D7 = 12;
constexpr std::array<double, 3 * N_SQUARE_D7> square_deg7 = {
    // clang-format off
3.9383136101878902e-01, -3.6699793434042738e-01, 5.2092862230230441e-01,
8.0196847620659251e-01, 8.0992592975809186e-01, 2.3740240561379911e-01,
-1.8327327664247231e-02, 9.2596092593108370e-01, 2.4166897208389651e-01,
3.6699793434042738e-01, 3.9383136101878902e-01, 5.2092862230230441e-01,
-8.0992592975809186e-01, 8.0196847620659251e-01, 2.3740240561379911e-01,
-9.2596092593108370e-01, -1.8327327664247231e-02, 2.4166897208389651e-01,
-3.9383136101878902e-01, 3.6699793434042738e-01, 5.2092862230230441e-01,
-8.0196847620659251e-01, -8.0992592975809186e-01, 2.3740240561379911e-01,
1.8327327664247231e-02, -9.2596092593108370e-01, 2.4166897208389651e-01,
-3.6699793434042738e-01, -3.9383136101878902e-01, 5.2092862230230441e-01,
8.0992592975809186e-01, -8.0196847620659251e-01, 2.3740240561379911e-01,
9.2596092593108370e-01, 1.8327327664247231e-02, 2.4166897208389651e-01,
    // clang-format on
};
//      	 	 ];
//
//
//     case  8
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     16
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 6.703e-15
//
//         XYW=[
constexpr size_t                              N_SQUARE_D8 = 16;
constexpr std::array<double, 3 * N_SQUARE_D8> square_deg8 = {
    // clang-format off
9.2002339792460985e-01, -1.0618112541850430e-01, 2.0668519708232971e-01,
8.9308544602061080e-01, 7.5384568688101028e-01, 1.6370848847293540e-01,
6.6753690615909911e-01, -6.6027698632401821e-01, 3.4487252886128372e-01,
9.7368418556113689e-01, -9.4189063979561116e-01, 4.1549900985740497e-02,
4.6340596705458059e-01, 9.7131462228677279e-01, 1.2077010705162870e-01,
5.2572510557221586e-01, 3.2843847839698259e-01, 4.7616121492980551e-01,
-3.1719060885857048e-01, 8.4316517196832175e-01, 8.7145648720949889e-02,
-6.1891136223418408e-02, 6.8532270046559662e-01, 3.7550787955205289e-01,
6.7208254240653312e-02, -2.6541376577695452e-01, 5.9394934221959950e-01,
1.9574786569504121e-01, -9.5313809850589404e-01, 1.5768230811451209e-01,
-7.2805912955956309e-01, 9.2456231671654276e-01, 1.2617480420464400e-01,
-5.5387754511188303e-01, 1.8494511431233790e-01, 4.9684228620650461e-01,
-4.4484469869796689e-01, -7.4179220431149029e-01, 3.6110247234938919e-01,
-9.4210813229475721e-01, 5.6527602987582715e-01, 1.4135724917325670e-01,
-8.9001069695662127e-01, -3.6263269719632368e-01, 2.3631887532692289e-01,
-8.8415589072944889e-01, -9.4185110772813063e-01, 7.0171696748444631e-02,
    // clang-format on
};
//      	 	 ];
//
//
//     case  9
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     17
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 8.882e-16
//
//         XYW=[
constexpr size_t                              N_SQUARE_D9 = 17;
constexpr std::array<double, 3 * N_SQUARE_D9> square_deg9 = {
    // clang-format off
-6.3068011973166871e-01, 9.6884996636197773e-01, 8.8879378170198711e-02,
4.5333982113564708e-01, -5.2373582021442944e-01, 3.9828243926207008e-01,
8.5261572933366236e-01, -7.6208328192617331e-02, 2.6905133763978067e-01,
-7.5027709997890069e-01, -9.2796164595956965e-01, 1.1209960212959651e-01,
-9.6884996636197773e-01, -6.3068011973166871e-01, 8.8879378170198711e-02,
5.2373582021442944e-01, 4.5333982113564708e-01, 3.9828243926207008e-01,
7.6208328192617331e-02, 8.5261572933366236e-01, 2.6905133763978067e-01,
9.2796164595956965e-01, -7.5027709997890069e-01, 1.1209960212959651e-01,
6.3068011973166871e-01, -9.6884996636197773e-01, 8.8879378170198711e-02,
-4.5333982113564708e-01, 5.2373582021442944e-01, 3.9828243926207008e-01,
-8.5261572933366236e-01, 7.6208328192617331e-02, 2.6905133763978067e-01,
7.5027709997890069e-01, 9.2796164595956965e-01, 1.1209960212959651e-01,
9.6884996636197773e-01, 6.3068011973166871e-01, 8.8879378170198711e-02,
-5.2373582021442944e-01, -4.5333982113564708e-01, 3.9828243926207008e-01,
-7.6208328192617331e-02, -8.5261572933366236e-01, 2.6905133763978067e-01,
-9.2796164595956965e-01, 7.5027709997890069e-01, 1.1209960212959651e-01,
0.0000000000000000e+00, 0.0000000000000000e+00, 5.2674897119341568e-01,
    // clang-format on
};
//      	 	 ];
//
//
//     case 10
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     22
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 4.441e-16
//
//         XYW=[
constexpr size_t                               N_SQUARE_D10 = 22;
constexpr std::array<double, 3 * N_SQUARE_D10> square_deg10 = {
    // clang-format off
9.4061855719921172e-01, -3.1884535968392930e-01, 1.1984158532391249e-01,
9.8171192640479699e-01, 6.2586619353239681e-01, 6.3269272761111064e-02,
8.1171510601648733e-01, 9.2466842429053542e-01, 8.8686202216975360e-02,
7.7882541598318522e-01, 2.1052738914821539e-01, 2.6587113477126079e-01,
6.4763548426267548e-01, -6.4749469817525440e-01, 2.3057004553370050e-01,
9.2254816825741193e-01, -8.7923480439903234e-01, 6.2537941187552334e-02,
1.1429517364223800e-01, 9.4921913140887004e-01, 1.1861767207465970e-01,
4.7113921490701688e-01, 6.6664733059821113e-01, 2.8395842218278972e-01,
3.5072672608918992e-01, -1.8447172062121969e-01, 3.8811447402440891e-01,
6.2402437958984680e-01, -9.8538331193145989e-01, 3.3387129247072961e-02,
-3.9247487539609610e-01, 7.6311149392438349e-01, 2.5827939410342832e-01,
-3.2110023120386577e-02, 3.1879357593640700e-01, 4.0824197726154571e-01,
-1.0733227865108710e-01, -6.1886619139299270e-01, 3.1498878221231119e-01,
2.0650134619887239e-01, -9.1195887103573448e-01, 1.3460977386198059e-01,
-7.5296563247996018e-01, 9.7071837396777472e-01, 5.9110195150351097e-02,
-7.6050655071397377e-01, 3.6631391678067909e-01, 2.6042397681916829e-01,
-4.7324898849276581e-01, -1.6557852510038329e-01, 3.7171764930896162e-01,
-5.0891319042960670e-01, -9.2152907557898267e-01, 1.3337731192240121e-01,
-9.5380192234255101e-01, 7.5512692061435538e-01, 7.1805898760516920e-02,
-9.6634208368735852e-01, -1.0431232556636380e-01, 9.7940429484131855e-02,
-8.1037492260191824e-01, -6.1159678303492493e-01, 2.0018320620277510e-01,
-9.5774959160007522e-01, -9.2621050012583894e-01, 3.4467525588983638e-02,
    // clang-format on
};
//      	 	 ];
//
//
//     case 11
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     24
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 3.539e-16
//
//         XYW=[
constexpr size_t                               N_SQUARE_D11 = 24;
constexpr std::array<double, 3 * N_SQUARE_D11> square_deg11 = {
    // clang-format off
-4.1658071912022282e-02, 4.2484724884866931e-01, 3.5115871839824547e-01,
3.1562343291525419e-01, 8.1252054830481324e-01, 2.1173634999894861e-01,
7.1200191307533633e-01, 5.2532025036454777e-01, 2.2562606172886340e-01,
6.9807610454956770e-01, 9.8263922354085553e-01, 4.8020763350723791e-02,
9.5353952820153209e-01, 1.8858613871864191e-01, 9.7386777358668172e-02,
9.3948638281673691e-01, 8.2577583590296399e-01, 6.6071329164550607e-02,
-4.2484724884866931e-01, -4.1658071912022282e-02, 3.5115871839824547e-01,
-8.1252054830481324e-01, 3.1562343291525419e-01, 2.1173634999894861e-01,
-5.2532025036454777e-01, 7.1200191307533633e-01, 2.2562606172886340e-01,
-9.8263922354085553e-01, 6.9807610454956770e-01, 4.8020763350723791e-02,
-1.8858613871864191e-01, 9.5353952820153209e-01, 9.7386777358668172e-02,
-8.2577583590296399e-01, 9.3948638281673691e-01, 6.6071329164550607e-02,
4.1658071912022282e-02, -4.2484724884866931e-01, 3.5115871839824547e-01,
-3.1562343291525419e-01, -8.1252054830481324e-01, 2.1173634999894861e-01,
-7.1200191307533633e-01, -5.2532025036454777e-01, 2.2562606172886340e-01,
-6.9807610454956770e-01, -9.8263922354085553e-01, 4.8020763350723791e-02,
-9.5353952820153209e-01, -1.8858613871864191e-01, 9.7386777358668172e-02,
-9.3948638281673691e-01, -8.2577583590296399e-01, 6.6071329164550607e-02,
4.2484724884866931e-01, 4.1658071912022282e-02, 3.5115871839824547e-01,
8.1252054830481324e-01, -3.1562343291525419e-01, 2.1173634999894861e-01,
5.2532025036454777e-01, -7.1200191307533633e-01, 2.2562606172886340e-01,
9.8263922354085553e-01, -6.9807610454956770e-01, 4.8020763350723791e-02,
1.8858613871864191e-01, -9.5353952820153209e-01, 9.7386777358668172e-02,
8.2577583590296399e-01, -9.3948638281673691e-01, 6.6071329164550607e-02,
    // clang-format on
};
//      	 	 ];
//
//
//     case 12
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     31
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 6.106e-16
//
//         XYW=[
constexpr size_t                               N_SQUARE_D12 = 31;
constexpr std::array<double, 3 * N_SQUARE_D12> square_deg12 = {
    // clang-format off
7.8879611335188593e-01, 9.7884230744443435e-01, 3.6437406530795052e-02,
9.6368033264575592e-01, -8.3251623771124039e-01, 4.1569463673074493e-02,
5.7270543923081496e-01, 7.7172612937827112e-01, 1.6803617935337870e-01,
9.6343026136113252e-01, 8.2547804637420463e-01, 4.2731042173621531e-02,
9.8502089416608585e-01, 2.9290384907130112e-03, 5.5271168279325850e-02,
8.5904862892311062e-01, -4.5682470235020622e-01, 1.5286344928777301e-01,
7.7307329845019923e-01, -9.6831290451933527e-01, 4.4131241473538210e-02,
-1.7796706981641100e-01, 7.0091873900974599e-01, 2.3284949129549240e-01,
8.5436381163057484e-01, 4.5185385848936449e-01, 1.5560451270058309e-01,
6.2912736835686800e-01, -7.5452835111532064e-03, 2.6255125704597038e-01,
5.5285796620237393e-01, -7.4450782760403678e-01, 1.8227203952572310e-01,
2.8384025794501933e-01, 4.1148556818189819e-01, 2.7661695413268073e-01,
-8.4616317040595079e-02, 8.8646095330861235e-02, 2.3838493672096511e-01,
2.4253241525537181e-01, -3.7420803863626728e-01, 2.9209733738763438e-01,
1.7323493723272099e-01, -9.3972086455750914e-01, 1.0209182756563170e-01,
1.7114095366096141e-01, 9.4051880305250479e-01, 1.0141341034978210e-01,
-4.1253792778957438e-01, 5.9323172962364973e-02, 1.4553359189913870e-01,
-2.1140021320948710e-01, -2.8409836354973778e-01, 7.9462185370518371e-02,
-4.9142062096966421e-01, 9.4534576929680092e-01, 8.4671005172644725e-02,
-6.0781466882291590e-01, 4.4867920649620080e-01, 2.2116792073930561e-01,
-5.7749937056104450e-01, -3.7585256213122781e-01, 2.1312886595671099e-01,
-4.9435489388780107e-01, -9.4872820339311759e-01, 8.1061670253741294e-02,
-8.3078328920423539e-01, 8.0569950029189197e-01, 1.0952311587869150e-01,
-8.7801063071481611e-01, 1.6612452958004101e-01, 9.5552054195582561e-02,
-9.8552079941549475e-01, -5.1723249358814272e-01, 4.4858746555370442e-02,
-1.8431576750903819e-01, -7.1064743675043296e-01, 2.2426363087274170e-01,
-9.6398082621116044e-01, 9.9351494404124996e-01, 1.1533432236047921e-02,
-9.9058904785580948e-01, 5.2806526254968800e-01, 4.0246262648181957e-02,
-8.7205371627670969e-01, -1.3290656319739139e-01, 1.0584496574955810e-01,
-9.2636578352034693e-01, -9.3725946433566398e-01, 3.4012874903626797e-02,
-7.7691289114270012e-01, -7.3393683341590776e-01, 1.2421796007216949e-01,
    // clang-format on
};
//      	 	 ];
//
//
//     case 13
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     33
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 8.882e-16
//
//         XYW=[
constexpr size_t                               N_SQUARE_D13 = 33;
constexpr std::array<double, 3 * N_SQUARE_D13> square_deg13 = {
    // clang-format off
4.7580862521827549e-01, 8.5007667369974882e-01, 1.1884466730059549e-01,
3.4271655604040691e-01, 4.0930456169403873e-01, 2.5687074948196781e-01,
7.5580535657208114e-01, 6.4782163718701102e-01, 1.2976355037000281e-01,
9.4132722587292506e-01, 3.9073621612946108e-01, 7.7492738533105454e-02,
9.5729769978630741e-01, 8.5955600564163881e-01, 3.8174421317083637e-02,
7.7880971155441947e-01, 9.8348668243987225e-01, 2.9991838864499139e-02,
-7.0741508996444685e-02, 6.9625007849174936e-01, 2.1334158145718940e-01,
1.3818345986246500e-01, 9.5892517028753499e-01, 6.0424923817749811e-02,
-8.5007667369974882e-01, 4.7580862521827549e-01, 1.1884466730059549e-01,
-4.0930456169403873e-01, 3.4271655604040691e-01, 2.5687074948196781e-01,
-6.4782163718701102e-01, 7.5580535657208114e-01, 1.2976355037000281e-01,
-3.9073621612946108e-01, 9.4132722587292506e-01, 7.7492738533105454e-02,
-8.5955600564163881e-01, 9.5729769978630741e-01, 3.8174421317083637e-02,
-9.8348668243987225e-01, 7.7880971155441947e-01, 2.9991838864499139e-02,
-6.9625007849174936e-01, -7.0741508996444685e-02, 2.1334158145718940e-01,
-9.5892517028753499e-01, 1.3818345986246500e-01, 6.0424923817749811e-02,
-4.7580862521827549e-01, -8.5007667369974882e-01, 1.1884466730059549e-01,
-3.4271655604040691e-01, -4.0930456169403873e-01, 2.5687074948196781e-01,
-7.5580535657208114e-01, -6.4782163718701102e-01, 1.2976355037000281e-01,
-9.4132722587292506e-01, -3.9073621612946108e-01, 7.7492738533105454e-02,
-9.5729769978630741e-01, -8.5955600564163881e-01, 3.8174421317083637e-02,
-7.7880971155441947e-01, -9.8348668243987225e-01, 2.9991838864499139e-02,
7.0741508996444685e-02, -6.9625007849174936e-01, 2.1334158145718940e-01,
-1.3818345986246500e-01, -9.5892517028753499e-01, 6.0424923817749811e-02,
8.5007667369974882e-01, -4.7580862521827549e-01, 1.1884466730059549e-01,
4.0930456169403873e-01, -3.4271655604040691e-01, 2.5687074948196781e-01,
6.4782163718701102e-01, -7.5580535657208114e-01, 1.2976355037000281e-01,
3.9073621612946108e-01, -9.4132722587292506e-01, 7.7492738533105454e-02,
8.5955600564163881e-01, -9.5729769978630741e-01, 3.8174421317083637e-02,
9.8348668243987225e-01, -7.7880971155441947e-01, 2.9991838864499139e-02,
6.9625007849174936e-01, 7.0741508996444685e-02, 2.1334158145718940e-01,
9.5892517028753499e-01, -1.3818345986246500e-01, 6.0424923817749811e-02,
0.0000000000000000e+00, 0.0000000000000000e+00, 3.0038211543122528e-01,
    // clang-format on
};
//      	 	 ];
//
//
//     case 14
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     40
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 9.680e-16
//
//         XYW=[
constexpr size_t                               N_SQUARE_D14 = 40;
constexpr std::array<double, 3 * N_SQUARE_D14> square_deg14 = {
    // clang-format off
9.7842472480916265e-01, 9.8493790373456791e-01, 7.0426092909748094e-03,
9.6960333671283905e-01, -3.3316333523583241e-01, 5.1270004016192312e-02,
9.6359079004336989e-01, -8.2351358276961917e-01, 2.8359041168349260e-02,
9.6096808536893363e-01, -9.6658480542093883e-01, 5.8025523412907351e-03,
8.7591752448243232e-01, 8.4405190169755540e-01, 6.4068397997811014e-02,
9.8506229778615528e-01, 5.9270068822727751e-01, 3.0598274531835879e-02,
9.1323781642629953e-01, 1.6866441074460459e-01, 1.0152933041778291e-01,
8.2102555752512796e-01, -6.3121384841147987e-01, 1.0705667921965760e-01,
7.2538026976467707e-01, 5.2712994242510802e-01, 1.4918502016826540e-01,
7.1299722346173067e-01, -1.7467253642066499e-01, 1.6726747296132430e-01,
5.5517819845443017e-01, -8.6176775694950969e-01, 1.0351662487287870e-01,
8.0476279465163514e-01, -9.6744327863793034e-01, 2.7870081382691689e-02,
6.4243731834390239e-01, 9.6600087371613175e-01, 4.2657042724923683e-02,
4.2026205880369027e-01, 7.8095961168872541e-01, 1.4250754667032800e-01,
4.5471666154708118e-01, 1.9274017175768979e-01, 2.1055161627916649e-01,
4.2599901435991627e-01, -4.9622087157686251e-01, 1.8671851729181360e-01,
9.7100210279545088e-02, 9.5369770824535671e-01, 6.9721824425892032e-02,
1.1140089194980241e-01, 4.9236162898969038e-01, 2.0439486183130329e-01,
1.2096671307582681e-01, -1.5034691008762541e-01, 2.3359305392804869e-01,
7.5240974000708727e-02, -7.4522532068107350e-01, 1.6012690266683430e-01,
-4.5186561964383892e-01, 9.4277957165822857e-01, 6.4652708342860812e-02,
-2.0402715753804920e-01, 7.5912240314181656e-01, 1.4669292213652410e-01,
-2.4278622188746249e-01, 1.7367088250324739e-01, 2.2802818710738751e-01,
-2.4597825857410610e-01, -4.4499559369225899e-01, 2.0552725770340849e-01,
2.1248524507229841e-01, -9.8107328332429322e-01, 4.3167692319290268e-02,
-7.5681082393817789e-01, 7.9011223155700461e-01, 9.5767216693031787e-02,
-5.4482026931146588e-01, 5.0343245488401234e-01, 1.7393151714936711e-01,
-5.9083857237624815e-01, -1.2689358671108081e-01, 1.9414900242977079e-01,
-2.8950463027109891e-01, -9.1161339119490981e-01, 9.6633451996031725e-02,
-6.4170367775263615e-01, -9.8867155612560820e-01, 2.2663312686610721e-02,
-7.9215951508138471e-01, 9.9553225185655680e-01, 1.3933823168935501e-02,
-9.5273130165597164e-01, 5.6882432845502451e-01, 5.6576033796633070e-02,
-8.3009124886102226e-01, 2.2620296307945670e-01, 1.3272234488789361e-01,
-5.7588390555401237e-01, -6.7563660155639205e-01, 1.3694817413729940e-01,
-7.9548801875819530e-01, -8.5066848694086517e-01, 6.0333219128621073e-02,
-9.5620075148726935e-01, 9.1399067779349685e-01, 2.4195465814254049e-02,
-9.8398765232597041e-01, -5.3815972687164718e-02, 4.1161105450212197e-02,
-8.5525180429441894e-01, -4.0020283809442492e-01, 1.1641781742633540e-01,
-9.6945917237785739e-01, -6.8235569928339912e-01, 3.4727562538020611e-02,
-9.4682829753678166e-01, -9.5062551139084461e-01, 1.7933730900148329e-02,
    // clang-format on
};
//      	 	 ];
//
//
//     case 15
//
//         % SET: SOMMARIVA FESTA
//         % CARDINALITY RULE  :     43
//         % EXTERNAL POINTS   :      0
//         % NEGATIVE WEIGHTS  :      0
//         % MOM.ERR. INF NORM : 3.331e-16
//
//         XYW=[
constexpr size_t                               N_SQUARE_D15 = 43;
constexpr std::array<double, 3 * N_SQUARE_D15> square_deg15 = {
    // clang-format off
-9.8970358093175448e-01, 5.4259073147428105e-01, 2.6920046374636200e-02,
-9.8442568043419620e-01, -8.6304334348311607e-01, 1.7495936638410380e-02,
-9.7207406129500273e-01, -3.5297709572153269e-01, 4.4073973300603808e-02,
-9.7175182224292522e-01, 9.6832140175312464e-01, 9.5979841170681333e-03,
-9.1927344389993804e-01, 1.1597891591564240e-01, 9.1866886363746916e-02,
-8.9207180079890802e-01, 8.0964477396780932e-01, 6.0090398477918687e-02,
-8.6945224159733303e-01, -9.7619610933459278e-01, 2.0996779525153039e-02,
-8.6852368922094936e-01, -6.7564596571063829e-01, 7.8228991556832078e-02,
-7.6303896105226543e-01, -4.5196518303707928e-01, 4.3237941166840668e-02,
-7.6067461388266111e-01, 4.7979621733430350e-01, 1.3414652025388379e-01,
-7.1517163101988512e-01, -1.8638334740250689e-01, 1.4560545556375751e-01,
-6.9873399625800514e-01, 9.5955710775234382e-01, 4.2266746477547440e-02,
-6.3484431559212651e-01, -8.7600064647540010e-01, 8.6065815763913298e-02,
-5.0342503021300444e-01, 7.5444763479649102e-01, 1.3364073589401951e-01,
-4.7956553973425581e-01, 1.7958097406839871e-01, 2.0290106772399860e-01,
-4.6399449741524912e-01, -5.7896946730137933e-01, 1.5608591719043999e-01,
-3.2441292515988912e-01, -9.8157978079640384e-01, 3.6697079793161252e-02,
-2.4133266018456059e-01, -2.5620943645466682e-01, 1.8059434768141261e-01,
-2.2898478575257819e-01, 9.4624541938633999e-01, 7.0005250560158772e-02,
-1.6481179010137781e-01, 5.0769306658709057e-01, 2.0088438517973600e-01,
-1.2207761564978201e-01, -8.0002258112803681e-01, 1.3832760610214051e-01,
0.0000000000000000e+00, 0.0000000000000000e+00, 1.6054026858924181e-01,
1.2207761564978201e-01, 8.0002258112803681e-01, 1.3832760610214051e-01,
1.6481179010137781e-01, -5.0769306658709057e-01, 2.0088438517973600e-01,
2.2898478575257819e-01, -9.4624541938633999e-01, 7.0005250560158772e-02,
2.4133266018456059e-01, 2.5620943645466682e-01, 1.8059434768141261e-01,
3.2441292515988912e-01, 9.8157978079640384e-01, 3.6697079793161252e-02,
4.6399449741524912e-01, 5.7896946730137933e-01, 1.5608591719043999e-01,
4.7956553973425581e-01, -1.7958097406839871e-01, 2.0290106772399860e-01,
5.0342503021300444e-01, -7.5444763479649102e-01, 1.3364073589401951e-01,
6.3484431559212651e-01, 8.7600064647540010e-01, 8.6065815763913298e-02,
6.9873399625800514e-01, -9.5955710775234382e-01, 4.2266746477547440e-02,
7.1517163101988512e-01, 1.8638334740250689e-01, 1.4560545556375751e-01,
7.6067461388266111e-01, -4.7979621733430350e-01, 1.3414652025388379e-01,
7.6303896105226543e-01, 4.5196518303707928e-01, 4.3237941166840668e-02,
8.6852368922094936e-01, 6.7564596571063829e-01, 7.8228991556832078e-02,
8.6945224159733303e-01, 9.7619610933459278e-01, 2.0996779525153039e-02,
8.9207180079890802e-01, -8.0964477396780932e-01, 6.0090398477918687e-02,
9.1927344389993804e-01, -1.1597891591564240e-01, 9.1866886363746916e-02,
9.7175182224292522e-01, -9.6832140175312464e-01, 9.5979841170681333e-03,
9.7207406129500273e-01, 3.5297709572153269e-01, 4.4073973300603808e-02,
9.8442568043419620e-01, 8.6304334348311607e-01, 1.7495936638410380e-02,
9.8970358093175448e-01, -5.4259073147428105e-01, 2.6920046374636200e-02,
    // clang-format on
};
//      	 	 ];
//
//
/********************************************************************************
 *  Journal of Computational and Applied Mathematics 218 (2008) 184 – 191
 *  Asymmetric cubature formulas for polynomial integration in the triangle and
 *  square.
 *
 *  Mark A. Taylor
 ********************************************************************************/
constexpr size_t                                  N_ASYMSQARE_D12 = 31;
constexpr std::array<double, 3 * N_ASYMSQARE_D12> asym_square_d12 = {
    // clang-format off
// x-coord                  y-coord                 cubature weight
-3.8131119459148788e-01, -1.5398000784199919e-01, 2.3598701292933691e-01,
6.4573191109453948e-02, -4.9794871568657245e-01, 2.4110813600847844e-01,
-1.0834321329194775e-02, 1.2224478971657705e-01, 2.7048224227639595e-01,
-3.1882703020851938e-01, -7.3294898893865745e-01, 1.8648166880884143e-01,
4.9124051440092803e-01, -7.8409257688727241e-01, 1.7241958393889878e-01,
-2.0906799447670715e-01, 6.5611051497298534e-01, 2.4109442092821515e-01,
1.8948337189272124e-01, 8.9911805536738287e-01, 1.4125391453247216e-01,
-6.9740094114568829e-01, -4.2248127033807525e-01, 1.8292025454973745e-01,
-5.8402513589553640e-01, 3.3100645378716304e-01, 2.2222997581864359e-01,
4.4701377237977313e-01, -2.2659664973677845e-01, 2.4904537785770031e-01,
3.4867912208378016e-01, 4.3860404955163790e-01, 2.5112362229462498e-01,
-8.2562697914640848e-01, -7.8339223275580994e-01, 9.2811359998802967e-02,
8.2839794669248942e-02, -9.4230798695085749e-01, 9.8238337173087234e-02,
-4.0351974647584699e-01, 9.6482881096343187e-01, 6.8583817743889233e-02,
6.5401042056406233e-01, 7.3857098028675039e-01, 1.5506938444449642e-01,
-9.0264377285460362e-01, -1.5881852211379360e-02, 1.3182320881366066e-01,
-8.5295397551927077e-01, 4.0163251602231481e-01, 6.0068518355283269e-02,
8.2216786295901656e-01, -5.2660748692256265e-01, 1.5766018519773284e-01,
7.4510555770497011e-01, 1.0988549815212308e-01, 1.9930860602643424e-01,
-9.4133986362315170e-01, -9.5414148142964417e-01, 2.1719109379092324e-02,
-5.4461187387612175e-01, -9.5530036379122441e-01, 6.4596098758824216e-02,
7.4407322966908984e-01, -9.7744835460673618e-01, 4.0584519909105145e-02,
-7.2254885481492603e-01, 7.9662230649630528e-01, 1.2603341007939087e-01,
6.7524406569352735e-01, 9.9626110485909680e-01, 3.0006912476756006e-02,
9.3807676975195520e-01, 8.8729244026658205e-01, 4.4974753329261395e-02,
-9.9171408764710778e-01, -5.2853945477454323e-01, 3.8721244577288268e-02,
-9.7391149358748841e-01, 5.9955340548238656e-01, 4.7718056922379071e-02,
-9.2231295237113653e-01, 9.5082592343728289e-01, 3.0056189691189335e-02,
9.5557708019583965e-01, -8.4903353418547223e-01, 4.4499282846528827e-02,
9.8216591295043421e-01, -1.6369711363774472e-01, 5.6566093223890265e-02,
9.2557212335129857e-01, 4.7425880434330858e-01, 9.6814701109561335e-02
    // clang-format on
};

} // namespace CubatureSets
} // namespace Fermi
